{
    "active_lock_reason": "too heated",
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\nimport_playbook\r\n\r\n##### ANSIBLE VERSION\r\n<!--- Paste verbatim output from \"ansible --version\" between quotes below -->\r\n```\r\n2.4.0.0\r\n```\r\n\r\n##### CONFIGURATION\r\n<!---\r\nIf using Ansible 2.4 or above, paste the results of \"ansible-config dump --only-changed\"\r\nOtherwise, mention any settings you have changed/added/removed in ansible.cfg\r\n(or using the ANSIBLE_* environment variables).\r\n-->\r\n\r\nn/a\r\n\r\n##### OS / ENVIRONMENT\r\n\r\nCentOS 6\r\n\r\n##### SUMMARY\r\n\r\nI need to conditionally import a playbook, which isn't possible.  The keyword I'm missing is \"include_playbook\" which would allow a \"when\" to apply to it.  Why?\r\n\r\nI have a playbook that performs some maintenance, OS, Kernel, package, and firmware upgrades.  For Major upgrades, we track progress in a ticketing system.  So, during those runs, I'd like to conditionally import a playbook that updates the ticket information.  In order for that to work, I need to pass the user's password to the ticketing system, so there's a `vars_prompt` in the ticket update playbook.  If the user specifies which ticket they're working to the maintenance playbook, I'd like the ticket update playbook to be called after the maintenance is performed.\r\n\r\nIf there's another way for this to work, I'm open to alternate ideas, but I think conditionally playbook imports would be generically useful.  I'm not understanding why tasks could be included dynamically, but a playbook wouldn't be.\r\n\r\n##### STEPS TO REPRODUCE\r\n<!---\r\nFor bugs, show exactly how to reproduce the problem, using a minimal test-case.\r\nFor new features, show how the feature would be used.\r\n-->\r\n\r\n<!--- Paste example playbooks or commands between quotes below -->\r\n```yaml\r\n# Maintenance Play Runs first, then conditionally import a second playbook\r\n- import_playbook: update-ticket.yaml\r\n  when: ticket_id is defined\r\n```\r\n\r\n<!--- You can also paste gist.github.com links for larger files -->\r\n\r\n##### EXPECTED RESULTS\r\n<!--- What did you expect to happen when running the steps above? -->\r\n\r\nI expect `update-ticket.yaml` to only import if the `ticket_id` is defined.\r\n\r\n##### ACTUAL RESULTS\r\n<!--- What actually happened? If possible run with extra verbosity (-vvvv) -->\r\n\r\nno parse error, and playbook `update-ticket.yaml` is imported 100% of the time.\r\n",
    "closed_at": "2022-03-26T16:03:16Z",
    "closed_by": {
        "avatar_url": "https://avatars.githubusercontent.com/u/6585283?v=4",
        "events_url": "https://api.github.com/users/ansibot/events{/privacy}",
        "followers_url": "https://api.github.com/users/ansibot/followers",
        "following_url": "https://api.github.com/users/ansibot/following{/other_user}",
        "gists_url": "https://api.github.com/users/ansibot/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/ansibot",
        "id": 6585283,
        "login": "ansibot",
        "node_id": "MDQ6VXNlcjY1ODUyODM=",
        "organizations_url": "https://api.github.com/users/ansibot/orgs",
        "received_events_url": "https://api.github.com/users/ansibot/received_events",
        "repos_url": "https://api.github.com/users/ansibot/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/ansibot/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/ansibot/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/ansibot"
    },
    "comments": 44,
    "comments_url": "https://api.github.com/repos/ansible/ansible/issues/34281/comments",
    "created_at": "2017-12-28T22:12:37Z",
    "events_url": "https://api.github.com/repos/ansible/ansible/issues/34281/events",
    "html_url": "https://github.com/ansible/ansible/issues/34281",
    "id": 284999235,
    "labels": [
        {
            "color": "1d76db",
            "default": false,
            "description": "This issue/PR relates to a module.",
            "id": 496359346,
            "name": "module",
            "node_id": "MDU6TGFiZWw0OTYzNTkzNDY=",
            "url": "https://api.github.com/repos/ansible/ansible/labels/module"
        },
        {
            "color": "ededed",
            "default": false,
            "description": "This issue/PR relates to code supported by the Ansible Engineering Team.",
            "id": 636352796,
            "name": "support:core",
            "node_id": "MDU6TGFiZWw2MzYzNTI3OTY=",
            "url": "https://api.github.com/repos/ansible/ansible/labels/support:core"
        },
        {
            "color": "5319e7",
            "default": false,
            "description": "This issue/PR affects Ansible v2.5",
            "id": 686214011,
            "name": "affects_2.5",
            "node_id": "MDU6TGFiZWw2ODYyMTQwMTE=",
            "url": "https://api.github.com/repos/ansible/ansible/labels/affects_2.5"
        },
        {
            "color": "1d76db",
            "default": false,
            "description": "This issue has an associated PR.",
            "id": 814251818,
            "name": "has_pr",
            "node_id": "MDU6TGFiZWw4MTQyNTE4MTg=",
            "url": "https://api.github.com/repos/ansible/ansible/labels/has_pr"
        },
        {
            "color": "006b75",
            "default": false,
            "description": "This issue/PR relates to a feature request.",
            "id": 852590921,
            "name": "feature",
            "node_id": "MDU6TGFiZWw4NTI1OTA5MjE=",
            "url": "https://api.github.com/repos/ansible/ansible/labels/feature"
        },
        {
            "color": "4071a5",
            "default": false,
            "description": "Utilities category",
            "id": 1231575790,
            "name": "utilities",
            "node_id": "MDU6TGFiZWwxMjMxNTc1Nzkw",
            "url": "https://api.github.com/repos/ansible/ansible/labels/utilities"
        },
        {
            "color": "ededed",
            "default": false,
            "description": null,
            "id": 2270557328,
            "name": "bot_closed",
            "node_id": "MDU6TGFiZWwyMjcwNTU3MzI4",
            "url": "https://api.github.com/repos/ansible/ansible/labels/bot_closed"
        }
    ],
    "labels_url": "https://api.github.com/repos/ansible/ansible/issues/34281/labels{/name}",
    "locked": true,
    "milestone": null,
    "node_id": "MDU6SXNzdWUyODQ5OTkyMzU=",
    "number": 34281,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 103,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 103,
        "url": "https://api.github.com/repos/ansible/ansible/issues/34281/reactions"
    },
    "repository_url": "https://api.github.com/repos/ansible/ansible",
    "state": "closed",
    "state_reason": "completed",
    "timeline_url": "https://api.github.com/repos/ansible/ansible/issues/34281/timeline",
    "title": "Conditionally import_playbook aka include_playbook",
    "updated_at": "2022-03-26T16:03:16Z",
    "url": "https://api.github.com/repos/ansible/ansible/issues/34281",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/99365?v=4",
        "events_url": "https://api.github.com/users/reyjrar/events{/privacy}",
        "followers_url": "https://api.github.com/users/reyjrar/followers",
        "following_url": "https://api.github.com/users/reyjrar/following{/other_user}",
        "gists_url": "https://api.github.com/users/reyjrar/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/reyjrar",
        "id": 99365,
        "login": "reyjrar",
        "node_id": "MDQ6VXNlcjk5MzY1",
        "organizations_url": "https://api.github.com/users/reyjrar/orgs",
        "received_events_url": "https://api.github.com/users/reyjrar/received_events",
        "repos_url": "https://api.github.com/users/reyjrar/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/reyjrar/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/reyjrar/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/reyjrar"
    }
}