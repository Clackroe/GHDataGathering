{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "body": "If you run `go tool test2json` with the `-t` flag, it produces some timing info in its structured output. Among them, an `Elapsed` field defined vaguely in the docs as\r\n```\r\nThe Elapsed field is set for \"pass\" and \"fail\" events. It gives the time elapsed for the specific test or the overall package test that passed or failed.\r\n```\r\nSo, the field is produced for either test or package-level pass/fail events. When referring to a single test, the Elapsed field generally measures how long that one test took (which is good).\r\nHowever, when the test binary times out (through the `-test.timeout` flag), the last entry produced by the `test2json` seems non-sensical: it claims that the test running when the timeout occurred took as long as the whole test binary took to run. In other words, all the tests' durations are accounted towards the one test that was running when the timeout occurs.\r\nFor example, with a test binary, say `kv.test`, if one does:\r\n```\r\n./kv.test -test.v -test.timeout=5s  2>&1 | go tool test2json -t > /tmp/out-streamed-timeout.json\r\n```\r\nThe last line of the tools output reads like:\r\n```\r\n{\"Time\":\"2018-09-08T11:00:49.477928549-04:00\",\"Action\":\"fail\",\"Test\":\"TestTxnDBReadSkewAnomaly\",\"Elapsed\":5.049}\r\n```\r\n\r\nSo, it claims that `TestTxnDBReadSkewAnomaly` ran for 5s. That's not true, as can be seen from the first line of tool output for that test:\r\n```\r\n{\"Time\":\"2018-09-08T11:00:48.676274586-04:00\",\"Action\":\"run\",\"Test\":\"TestTxnDBReadSkewAnomaly\"}\r\n```\r\n\r\nThe test in fact ran for less than one second.\r\nA good guess is that the tool got confused about what context its in when printing the last line, and looked at the whole test binary duration - which is around 5s as can be see by looking at the first line of output:\r\n```\r\n{\"Time\":\"2018-09-08T11:00:44.462501938-04:00\",\"Action\":\"run\",\"Test\":\"TestBatchPrevNext\"}\r\n```\r\n\r\n\r\n\r\n### What version of Go are you using (`go version`)?\r\ngo version go1.10 darwin/amd64\r\n\r\n### Does this issue reproduce with the latest release?\r\nYes, reproduced with go1.11 too\r\n\r\n### What operating system and processor architecture are you using (`go env`)?\r\nReproduced on both OSX and Linux.\r\n\r\n",
    "closed_at": "2022-10-26T19:51:39Z",
    "closed_by": {
        "avatar_url": "https://avatars.githubusercontent.com/u/8566911?v=4",
        "events_url": "https://api.github.com/users/gopherbot/events{/privacy}",
        "followers_url": "https://api.github.com/users/gopherbot/followers",
        "following_url": "https://api.github.com/users/gopherbot/following{/other_user}",
        "gists_url": "https://api.github.com/users/gopherbot/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/gopherbot",
        "id": 8566911,
        "login": "gopherbot",
        "node_id": "MDQ6VXNlcjg1NjY5MTE=",
        "organizations_url": "https://api.github.com/users/gopherbot/orgs",
        "received_events_url": "https://api.github.com/users/gopherbot/received_events",
        "repos_url": "https://api.github.com/users/gopherbot/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/gopherbot/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/gopherbot/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/gopherbot"
    },
    "comments": 3,
    "comments_url": "https://api.github.com/repos/golang/go/issues/27568/comments",
    "created_at": "2018-09-08T15:23:30Z",
    "events_url": "https://api.github.com/repos/golang/go/issues/27568/events",
    "html_url": "https://github.com/golang/go/issues/27568",
    "id": 358304292,
    "labels": [
        {
            "color": "ededed",
            "default": false,
            "description": "The path to resolution is known, but the work has not been done.",
            "id": 373399998,
            "name": "NeedsFix",
            "node_id": "MDU6TGFiZWwzNzMzOTk5OTg=",
            "url": "https://api.github.com/repos/golang/go/labels/NeedsFix"
        }
    ],
    "labels_url": "https://api.github.com/repos/golang/go/issues/27568/labels{/name}",
    "locked": false,
    "milestone": {
        "closed_at": "2023-02-01T19:05:17Z",
        "closed_issues": 479,
        "created_at": "2022-03-01T14:15:50Z",
        "creator": {
            "avatar_url": "https://avatars.githubusercontent.com/u/146817?v=4",
            "events_url": "https://api.github.com/users/cagedmantis/events{/privacy}",
            "followers_url": "https://api.github.com/users/cagedmantis/followers",
            "following_url": "https://api.github.com/users/cagedmantis/following{/other_user}",
            "gists_url": "https://api.github.com/users/cagedmantis/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/cagedmantis",
            "id": 146817,
            "login": "cagedmantis",
            "node_id": "MDQ6VXNlcjE0NjgxNw==",
            "organizations_url": "https://api.github.com/users/cagedmantis/orgs",
            "received_events_url": "https://api.github.com/users/cagedmantis/received_events",
            "repos_url": "https://api.github.com/users/cagedmantis/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/cagedmantis/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/cagedmantis/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/cagedmantis"
        },
        "description": "",
        "due_on": null,
        "html_url": "https://github.com/golang/go/milestone/250",
        "id": 7725061,
        "labels_url": "https://api.github.com/repos/golang/go/milestones/250/labels",
        "node_id": "MI_kwDOAWBuf84AdeAF",
        "number": 250,
        "open_issues": 1,
        "state": "closed",
        "title": "Go1.20",
        "updated_at": "2023-06-04T19:32:17Z",
        "url": "https://api.github.com/repos/golang/go/milestones/250"
    },
    "node_id": "MDU6SXNzdWUzNTgzMDQyOTI=",
    "number": 27568,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/golang/go/issues/27568/reactions"
    },
    "repository_url": "https://api.github.com/repos/golang/go",
    "state": "closed",
    "state_reason": "completed",
    "timeline_url": "https://api.github.com/repos/golang/go/issues/27568/timeline",
    "title": "cmd/test2json: bogus `Elapsed` field computed when test times out",
    "updated_at": "2022-11-18T17:46:36Z",
    "url": "https://api.github.com/repos/golang/go/issues/27568",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/377201?v=4",
        "events_url": "https://api.github.com/users/andreimatei/events{/privacy}",
        "followers_url": "https://api.github.com/users/andreimatei/followers",
        "following_url": "https://api.github.com/users/andreimatei/following{/other_user}",
        "gists_url": "https://api.github.com/users/andreimatei/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/andreimatei",
        "id": 377201,
        "login": "andreimatei",
        "node_id": "MDQ6VXNlcjM3NzIwMQ==",
        "organizations_url": "https://api.github.com/users/andreimatei/orgs",
        "received_events_url": "https://api.github.com/users/andreimatei/received_events",
        "repos_url": "https://api.github.com/users/andreimatei/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/andreimatei/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/andreimatei/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/andreimatei"
    }
}