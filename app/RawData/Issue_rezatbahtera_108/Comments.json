[
    {
        "author_association": "MEMBER",
        "body": "Hmm... this _was_ working on 2010 initially. Investigating.",
        "created_at": "2021-03-07T04:54:02Z",
        "html_url": "https://github.com/microsoft/CSS-Exchange/issues/108#issuecomment-792210223",
        "id": 792210223,
        "issue_url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/108",
        "node_id": "MDEyOklzc3VlQ29tbWVudDc5MjIxMDIyMw==",
        "performed_via_github_app": null,
        "reactions": {
            "+1": 0,
            "-1": 0,
            "confused": 0,
            "eyes": 0,
            "heart": 0,
            "hooray": 0,
            "laugh": 0,
            "rocket": 0,
            "total_count": 0,
            "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/792210223/reactions"
        },
        "updated_at": "2021-03-07T04:54:02Z",
        "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/792210223",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/4518572?v=4",
            "events_url": "https://api.github.com/users/bill-long/events{/privacy}",
            "followers_url": "https://api.github.com/users/bill-long/followers",
            "following_url": "https://api.github.com/users/bill-long/following{/other_user}",
            "gists_url": "https://api.github.com/users/bill-long/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/bill-long",
            "id": 4518572,
            "login": "bill-long",
            "node_id": "MDQ6VXNlcjQ1MTg1NzI=",
            "organizations_url": "https://api.github.com/users/bill-long/orgs",
            "received_events_url": "https://api.github.com/users/bill-long/received_events",
            "repos_url": "https://api.github.com/users/bill-long/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/bill-long/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bill-long/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/bill-long"
        }
    },
    {
        "author_association": "MEMBER",
        "body": "It's definitely broken when running _locally_ on 2010, and there are several changes needed to get it working due to the older version of PowerShell.\r\n\r\nOne option is to Enable-PSRemoting on 2010 and then run it from somewhere else, using the -ComputerName parameter to point it to the 2010 server. That does work.\r\n\r\nAnother option is to run the blog commands manually on 2010.\r\n\r\nKeep in mind that the script is of limited use on 2010 even in a fully working state. The commands from the blog post search several folders that don't exist on 2010. I think the goal for this script will be to run the tests we can, remotely, against 2010, and fail gracefully where the tests don't apply to 2010.",
        "created_at": "2021-03-07T05:31:41Z",
        "html_url": "https://github.com/microsoft/CSS-Exchange/issues/108#issuecomment-792220774",
        "id": 792220774,
        "issue_url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/108",
        "node_id": "MDEyOklzc3VlQ29tbWVudDc5MjIyMDc3NA==",
        "performed_via_github_app": null,
        "reactions": {
            "+1": 1,
            "-1": 0,
            "confused": 0,
            "eyes": 0,
            "heart": 0,
            "hooray": 0,
            "laugh": 0,
            "rocket": 0,
            "total_count": 1,
            "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/792220774/reactions"
        },
        "updated_at": "2021-03-07T05:31:41Z",
        "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/792220774",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/4518572?v=4",
            "events_url": "https://api.github.com/users/bill-long/events{/privacy}",
            "followers_url": "https://api.github.com/users/bill-long/followers",
            "following_url": "https://api.github.com/users/bill-long/following{/other_user}",
            "gists_url": "https://api.github.com/users/bill-long/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/bill-long",
            "id": 4518572,
            "login": "bill-long",
            "node_id": "MDQ6VXNlcjQ1MTg1NzI=",
            "organizations_url": "https://api.github.com/users/bill-long/orgs",
            "received_events_url": "https://api.github.com/users/bill-long/received_events",
            "repos_url": "https://api.github.com/users/bill-long/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/bill-long/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bill-long/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/bill-long"
        }
    },
    {
        "author_association": "NONE",
        "body": "Confirming SBS 2011 when run locally is throwing the same error.\r\nPlease fix as this is the only server in infrastructure so no remote option possible.",
        "created_at": "2021-03-07T06:38:25Z",
        "html_url": "https://github.com/microsoft/CSS-Exchange/issues/108#issuecomment-792227054",
        "id": 792227054,
        "issue_url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/108",
        "node_id": "MDEyOklzc3VlQ29tbWVudDc5MjIyNzA1NA==",
        "performed_via_github_app": null,
        "reactions": {
            "+1": 0,
            "-1": 0,
            "confused": 0,
            "eyes": 0,
            "heart": 0,
            "hooray": 0,
            "laugh": 0,
            "rocket": 0,
            "total_count": 0,
            "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/792227054/reactions"
        },
        "updated_at": "2021-03-07T06:38:25Z",
        "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/792227054",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/18152490?v=4",
            "events_url": "https://api.github.com/users/dinonovak/events{/privacy}",
            "followers_url": "https://api.github.com/users/dinonovak/followers",
            "following_url": "https://api.github.com/users/dinonovak/following{/other_user}",
            "gists_url": "https://api.github.com/users/dinonovak/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/dinonovak",
            "id": 18152490,
            "login": "dinonovak",
            "node_id": "MDQ6VXNlcjE4MTUyNDkw",
            "organizations_url": "https://api.github.com/users/dinonovak/orgs",
            "received_events_url": "https://api.github.com/users/dinonovak/received_events",
            "repos_url": "https://api.github.com/users/dinonovak/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/dinonovak/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/dinonovak/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/dinonovak"
        }
    },
    {
        "author_association": "NONE",
        "body": "Try to bind the $credential function with = get-credential \"domain\\username\", you know you need at least PS Version 4.0. ",
        "created_at": "2021-03-07T10:14:20Z",
        "html_url": "https://github.com/microsoft/CSS-Exchange/issues/108#issuecomment-792251372",
        "id": 792251372,
        "issue_url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/108",
        "node_id": "MDEyOklzc3VlQ29tbWVudDc5MjI1MTM3Mg==",
        "performed_via_github_app": null,
        "reactions": {
            "+1": 0,
            "-1": 0,
            "confused": 0,
            "eyes": 0,
            "heart": 0,
            "hooray": 0,
            "laugh": 0,
            "rocket": 0,
            "total_count": 0,
            "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/792251372/reactions"
        },
        "updated_at": "2021-03-07T10:24:41Z",
        "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/792251372",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/32583956?v=4",
            "events_url": "https://api.github.com/users/mahmoudshoaala/events{/privacy}",
            "followers_url": "https://api.github.com/users/mahmoudshoaala/followers",
            "following_url": "https://api.github.com/users/mahmoudshoaala/following{/other_user}",
            "gists_url": "https://api.github.com/users/mahmoudshoaala/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/mahmoudshoaala",
            "id": 32583956,
            "login": "mahmoudshoaala",
            "node_id": "MDQ6VXNlcjMyNTgzOTU2",
            "organizations_url": "https://api.github.com/users/mahmoudshoaala/orgs",
            "received_events_url": "https://api.github.com/users/mahmoudshoaala/received_events",
            "repos_url": "https://api.github.com/users/mahmoudshoaala/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/mahmoudshoaala/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/mahmoudshoaala/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/mahmoudshoaala"
        }
    },
    {
        "author_association": "NONE",
        "body": "Check if your shortcut to \"Exchange Management Shell\" includes \"-version 2.0\" in the parameters.\r\nIf so, remove this and try again.\r\n![Exchange Management Shell](https://user-images.githubusercontent.com/4739672/110307573-5ab2fe00-7fff-11eb-8d92-1658d52521cd.png)\r\n",
        "created_at": "2021-03-08T10:13:57Z",
        "html_url": "https://github.com/microsoft/CSS-Exchange/issues/108#issuecomment-792647251",
        "id": 792647251,
        "issue_url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/108",
        "node_id": "MDEyOklzc3VlQ29tbWVudDc5MjY0NzI1MQ==",
        "performed_via_github_app": null,
        "reactions": {
            "+1": 1,
            "-1": 0,
            "confused": 0,
            "eyes": 0,
            "heart": 0,
            "hooray": 0,
            "laugh": 0,
            "rocket": 0,
            "total_count": 1,
            "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/792647251/reactions"
        },
        "updated_at": "2021-03-08T10:13:57Z",
        "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/792647251",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/4739672?v=4",
            "events_url": "https://api.github.com/users/Wizzdk/events{/privacy}",
            "followers_url": "https://api.github.com/users/Wizzdk/followers",
            "following_url": "https://api.github.com/users/Wizzdk/following{/other_user}",
            "gists_url": "https://api.github.com/users/Wizzdk/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/Wizzdk",
            "id": 4739672,
            "login": "Wizzdk",
            "node_id": "MDQ6VXNlcjQ3Mzk2NzI=",
            "organizations_url": "https://api.github.com/users/Wizzdk/orgs",
            "received_events_url": "https://api.github.com/users/Wizzdk/received_events",
            "repos_url": "https://api.github.com/users/Wizzdk/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/Wizzdk/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/Wizzdk/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/Wizzdk"
        }
    },
    {
        "author_association": "NONE",
        "body": "The script should start with `#Requires -Version 4` to prevent people trying to use it in the wrong version of PowerShell.",
        "created_at": "2021-03-08T13:33:07Z",
        "html_url": "https://github.com/microsoft/CSS-Exchange/issues/108#issuecomment-792759073",
        "id": 792759073,
        "issue_url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/108",
        "node_id": "MDEyOklzc3VlQ29tbWVudDc5Mjc1OTA3Mw==",
        "performed_via_github_app": null,
        "reactions": {
            "+1": 3,
            "-1": 0,
            "confused": 0,
            "eyes": 0,
            "heart": 0,
            "hooray": 0,
            "laugh": 0,
            "rocket": 0,
            "total_count": 3,
            "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/792759073/reactions"
        },
        "updated_at": "2021-03-08T13:33:07Z",
        "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/792759073",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/18154705?v=4",
            "events_url": "https://api.github.com/users/JeremyTBradshaw/events{/privacy}",
            "followers_url": "https://api.github.com/users/JeremyTBradshaw/followers",
            "following_url": "https://api.github.com/users/JeremyTBradshaw/following{/other_user}",
            "gists_url": "https://api.github.com/users/JeremyTBradshaw/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/JeremyTBradshaw",
            "id": 18154705,
            "login": "JeremyTBradshaw",
            "node_id": "MDQ6VXNlcjE4MTU0NzA1",
            "organizations_url": "https://api.github.com/users/JeremyTBradshaw/orgs",
            "received_events_url": "https://api.github.com/users/JeremyTBradshaw/received_events",
            "repos_url": "https://api.github.com/users/JeremyTBradshaw/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/JeremyTBradshaw/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/JeremyTBradshaw/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/JeremyTBradshaw"
        }
    },
    {
        "author_association": "MEMBER",
        "body": "You can also remove the PSCredential requirement if that's the blocker. I haven't seen a case where we need to pass credentials. Just delete this line:\r\n\r\n`[pscredential]`\r\n\r\nOr change it to some other data type:\r\n\r\n`[string]`\r\n\r\nHowever, when I do that on my 2010 machine I immediately run into other issues.",
        "created_at": "2021-03-08T14:18:49Z",
        "html_url": "https://github.com/microsoft/CSS-Exchange/issues/108#issuecomment-792785705",
        "id": 792785705,
        "issue_url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/108",
        "node_id": "MDEyOklzc3VlQ29tbWVudDc5Mjc4NTcwNQ==",
        "performed_via_github_app": null,
        "reactions": {
            "+1": 0,
            "-1": 0,
            "confused": 0,
            "eyes": 0,
            "heart": 0,
            "hooray": 0,
            "laugh": 0,
            "rocket": 0,
            "total_count": 0,
            "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/792785705/reactions"
        },
        "updated_at": "2021-03-08T14:28:46Z",
        "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/792785705",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/4518572?v=4",
            "events_url": "https://api.github.com/users/bill-long/events{/privacy}",
            "followers_url": "https://api.github.com/users/bill-long/followers",
            "following_url": "https://api.github.com/users/bill-long/following{/other_user}",
            "gists_url": "https://api.github.com/users/bill-long/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/bill-long",
            "id": 4518572,
            "login": "bill-long",
            "node_id": "MDQ6VXNlcjQ1MTg1NzI=",
            "organizations_url": "https://api.github.com/users/bill-long/orgs",
            "received_events_url": "https://api.github.com/users/bill-long/received_events",
            "repos_url": "https://api.github.com/users/bill-long/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/bill-long/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bill-long/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/bill-long"
        }
    },
    {
        "author_association": "NONE",
        "body": "I change [pscredential] to [string] and got it:\r\n\r\n[PS] D:\\Downloads>.\\Test-ProxyLogon.ps1 -OutPath .\\logs\r\ncmdlet Write-Progress at command pipeline position 1\r\nSupply values for the following parameters:\r\n(Type !? for Help.)\r\nStatus:",
        "created_at": "2021-03-08T15:09:41Z",
        "html_url": "https://github.com/microsoft/CSS-Exchange/issues/108#issuecomment-792818873",
        "id": 792818873,
        "issue_url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/108",
        "node_id": "MDEyOklzc3VlQ29tbWVudDc5MjgxODg3Mw==",
        "performed_via_github_app": null,
        "reactions": {
            "+1": 0,
            "-1": 0,
            "confused": 0,
            "eyes": 0,
            "heart": 0,
            "hooray": 0,
            "laugh": 0,
            "rocket": 0,
            "total_count": 0,
            "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/792818873/reactions"
        },
        "updated_at": "2021-03-08T15:09:41Z",
        "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/792818873",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/44499907?v=4",
            "events_url": "https://api.github.com/users/live-motion/events{/privacy}",
            "followers_url": "https://api.github.com/users/live-motion/followers",
            "following_url": "https://api.github.com/users/live-motion/following{/other_user}",
            "gists_url": "https://api.github.com/users/live-motion/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/live-motion",
            "id": 44499907,
            "login": "live-motion",
            "node_id": "MDQ6VXNlcjQ0NDk5OTA3",
            "organizations_url": "https://api.github.com/users/live-motion/orgs",
            "received_events_url": "https://api.github.com/users/live-motion/received_events",
            "repos_url": "https://api.github.com/users/live-motion/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/live-motion/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/live-motion/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/live-motion"
        }
    },
    {
        "author_association": "MEMBER",
        "body": "For the \"Status:\" prompt, you can change every `Write-Progress` command in the script so that it has a -Status parameter. For example, change:\r\n\r\n`Write-Progress -Activity \"Checking for CVE-2021-26855 in the HttpProxy logs\"`\r\n\r\nTo:\r\n\r\n`Write-Progress -Activity \"Checking for CVE-2021-26855 in the HttpProxy logs\" -Status \"Checking\"`\r\n\r\nHowever, after you fix that you are going to run into another issue... This series of issues is why there isn't an update that makes this work locally on 2010 yet. We're looking into it again today.",
        "created_at": "2021-03-08T15:50:16Z",
        "html_url": "https://github.com/microsoft/CSS-Exchange/issues/108#issuecomment-792846367",
        "id": 792846367,
        "issue_url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/108",
        "node_id": "MDEyOklzc3VlQ29tbWVudDc5Mjg0NjM2Nw==",
        "performed_via_github_app": null,
        "reactions": {
            "+1": 0,
            "-1": 0,
            "confused": 0,
            "eyes": 0,
            "heart": 0,
            "hooray": 0,
            "laugh": 0,
            "rocket": 0,
            "total_count": 0,
            "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/792846367/reactions"
        },
        "updated_at": "2021-03-08T15:50:16Z",
        "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/792846367",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/4518572?v=4",
            "events_url": "https://api.github.com/users/bill-long/events{/privacy}",
            "followers_url": "https://api.github.com/users/bill-long/followers",
            "following_url": "https://api.github.com/users/bill-long/following{/other_user}",
            "gists_url": "https://api.github.com/users/bill-long/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/bill-long",
            "id": 4518572,
            "login": "bill-long",
            "node_id": "MDQ6VXNlcjQ1MTg1NzI=",
            "organizations_url": "https://api.github.com/users/bill-long/orgs",
            "received_events_url": "https://api.github.com/users/bill-long/received_events",
            "repos_url": "https://api.github.com/users/bill-long/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/bill-long/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bill-long/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/bill-long"
        }
    },
    {
        "author_association": "NONE",
        "body": "Running Exchange 2010 on Windows Server 2008 R2 (I know it's EOL, we are decom'ing soon).  I upgraded the installed version of PS to 5.1 and reran the script.  Instead of getting the [pscredential] error now, I get this instead:\r\n\r\nImport-Csv : Cannot validate argument on parameter 'Path'. The argument is null or empty. Provide an argument that is\r\nnot null or empty, and then try the command again.\r\nAt C:\\XXXX\\HAFNIUM Test Scipts\\Test-ProxyLogon.ps1:122 char:63\r\n+ ...                          $fileResults = @(Import-Csv -Path $_ -ErrorA ...\r\n+                                                                ~~\r\n    + CategoryInfo          : InvalidData: (:) [Import-Csv], ParameterBindingValidationException\r\n    + FullyQualifiedErrorId : ParameterArgumentValidationError,Microsoft.PowerShell.Commands.ImportCsvCommand\r\n\r\nGet-ChildItem : Access to the path 'C:\\Windows\\temp\\XCCache' is denied.\r\nAt C:\\XXXX\\HAFNIUM Test Scipts\\Test-ProxyLogon.ps1:166 char:39\r\n+ ... h ($file in Get-ChildItem -Recurse -Path \"$env:WINDIR\\temp\\lsass.*dmp ...\r\n+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n    + CategoryInfo          : PermissionDenied: (C:\\Windows\\temp\\XCCache:String) [Get-ChildItem], UnauthorizedAccessEx\r\n   ception\r\n    + FullyQualifiedErrorId : DirUnauthorizedAccessError,Microsoft.PowerShell.Commands.GetChildItemCommand\r\n\r\nAny ideas?",
        "created_at": "2021-03-08T19:15:18Z",
        "html_url": "https://github.com/microsoft/CSS-Exchange/issues/108#issuecomment-793004768",
        "id": 793004768,
        "issue_url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/108",
        "node_id": "MDEyOklzc3VlQ29tbWVudDc5MzAwNDc2OA==",
        "performed_via_github_app": null,
        "reactions": {
            "+1": 0,
            "-1": 0,
            "confused": 0,
            "eyes": 0,
            "heart": 0,
            "hooray": 0,
            "laugh": 0,
            "rocket": 0,
            "total_count": 0,
            "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/793004768/reactions"
        },
        "updated_at": "2021-03-08T19:15:58Z",
        "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/793004768",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/80279655?v=4",
            "events_url": "https://api.github.com/users/jakewalkeruct/events{/privacy}",
            "followers_url": "https://api.github.com/users/jakewalkeruct/followers",
            "following_url": "https://api.github.com/users/jakewalkeruct/following{/other_user}",
            "gists_url": "https://api.github.com/users/jakewalkeruct/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/jakewalkeruct",
            "id": 80279655,
            "login": "jakewalkeruct",
            "node_id": "MDQ6VXNlcjgwMjc5NjU1",
            "organizations_url": "https://api.github.com/users/jakewalkeruct/orgs",
            "received_events_url": "https://api.github.com/users/jakewalkeruct/received_events",
            "repos_url": "https://api.github.com/users/jakewalkeruct/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/jakewalkeruct/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jakewalkeruct/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/jakewalkeruct"
        }
    },
    {
        "author_association": "MEMBER",
        "body": "I've been trying to get this working on Exchange 2010 today. However, after some discussions, we've decided not to support running the script on 2010.\r\n\r\nThe main reason for this is that Exchange 2010 is only vulnerable to CVE-2021-26857. That means only one of the commands from the blog applies to 2010:\r\n\r\n`Get-EventLog -LogName Application -Source \"MSExchange Unified Messaging\" -EntryType Error | Where-Object { $_.Message -like \"*System.InvalidCastException*\" }`\r\n\r\nNone of the other checks have any value on Exchange 2010, so the script isn't doing much for you. There's a longer explanation regarding 2010 here:\r\n\r\nhttps://techcommunity.microsoft.com/t5/exchange-team-blog/released-march-2021-exchange-server-security-updates/bc-p/2190541/highlight/true#M29790",
        "created_at": "2021-03-08T20:17:09Z",
        "html_url": "https://github.com/microsoft/CSS-Exchange/issues/108#issuecomment-793045938",
        "id": 793045938,
        "issue_url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/108",
        "node_id": "MDEyOklzc3VlQ29tbWVudDc5MzA0NTkzOA==",
        "performed_via_github_app": null,
        "reactions": {
            "+1": 3,
            "-1": 0,
            "confused": 0,
            "eyes": 0,
            "heart": 0,
            "hooray": 0,
            "laugh": 0,
            "rocket": 0,
            "total_count": 3,
            "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/793045938/reactions"
        },
        "updated_at": "2021-03-08T20:17:09Z",
        "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/793045938",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/4518572?v=4",
            "events_url": "https://api.github.com/users/bill-long/events{/privacy}",
            "followers_url": "https://api.github.com/users/bill-long/followers",
            "following_url": "https://api.github.com/users/bill-long/following{/other_user}",
            "gists_url": "https://api.github.com/users/bill-long/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/bill-long",
            "id": 4518572,
            "login": "bill-long",
            "node_id": "MDQ6VXNlcjQ1MTg1NzI=",
            "organizations_url": "https://api.github.com/users/bill-long/orgs",
            "received_events_url": "https://api.github.com/users/bill-long/received_events",
            "repos_url": "https://api.github.com/users/bill-long/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/bill-long/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bill-long/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/bill-long"
        }
    },
    {
        "author_association": "NONE",
        "body": "Hi! Thanks for the work on this repo.\r\n\r\nRequiring PSv4 is a serious breaking change. I'm sure a lot of thought went in that I don't see, but - on the surface - it's a puzzling decision. I have thousands of wildly heterogenous boxes. I still have many paying customers on PSv2, for my sins! I don't expect you to support PSv2 in this day and age, but jumping past PSv3 should be a considered move. PSv3 is where the language hit maturity. Excepting classes and DSC, it's basically only syntax sugar between 3 and 6.\r\n\r\nAFAICS, the use of `[pscredential]` in no way requires PSv4. Perhaps this is symptomatic of some other issue, possibly relating to how the Exchange Management Shell works. I'm running this script without touching the EMS, in a general-purpose automation framework. @mahmoudshoaala I'd be interested to see your repro. I suspect you have some other issue going on.\r\n\r\nHere's the part I don't see. IIUC, you've merged #153 in order to handle a bug in a parameter at https://github.com/microsoft/CSS-Exchange/blob/58cc16f/Security/Test-ProxyLogon.ps1#L67 that _isn't in use_.\r\n\r\nBased on that, my recommendation and request is:\r\n- roll back https://github.com/microsoft/CSS-Exchange/pull/153\r\n- change the param type to `[object]` and perform type-checking in the function body",
        "created_at": "2021-03-09T11:59:19Z",
        "html_url": "https://github.com/microsoft/CSS-Exchange/issues/108#issuecomment-793783187",
        "id": 793783187,
        "issue_url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/108",
        "node_id": "MDEyOklzc3VlQ29tbWVudDc5Mzc4MzE4Nw==",
        "performed_via_github_app": null,
        "reactions": {
            "+1": 0,
            "-1": 0,
            "confused": 0,
            "eyes": 0,
            "heart": 0,
            "hooray": 0,
            "laugh": 0,
            "rocket": 0,
            "total_count": 0,
            "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/793783187/reactions"
        },
        "updated_at": "2021-03-09T12:25:48Z",
        "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/793783187",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/3678789?v=4",
            "events_url": "https://api.github.com/users/fsackur/events{/privacy}",
            "followers_url": "https://api.github.com/users/fsackur/followers",
            "following_url": "https://api.github.com/users/fsackur/following{/other_user}",
            "gists_url": "https://api.github.com/users/fsackur/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/fsackur",
            "id": 3678789,
            "login": "fsackur",
            "node_id": "MDQ6VXNlcjM2Nzg3ODk=",
            "organizations_url": "https://api.github.com/users/fsackur/orgs",
            "received_events_url": "https://api.github.com/users/fsackur/received_events",
            "repos_url": "https://api.github.com/users/fsackur/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/fsackur/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/fsackur/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/fsackur"
        }
    },
    {
        "author_association": "NONE",
        "body": "The real issue is the way the code has been packaged into a single file. Many of us don't want \"output\" as a sequence of write-host commands. That's a real backwards step - if I want to parse text, I have plenty of crappy vendor tools to waste my time on. We do structured data in powershell.\r\n\r\nI would be willing to PR something that remains a single runnable file, but exports the functions so that it can be consumed by automation frameworks. That would give users the choice between write-host or objects. \r\n\r\nIf I do this, it will be a time burden for me and the reviewers, and it would carry some level of risk, so let me know if this would be helpful!\r\n\r\nIn the meantime, I NEVER want to be copy-pasting code from version control, so I have the following snippet, which gives me flexibility to pull changes in my repo from this repo. I offer it in case anyone else has the same problem:\r\n\r\n```powershell\r\n# replace as appropriate\r\n$MSScriptPath = \"./CSS-Exchange/Test-ProxyLogon.ps1\"\r\n\r\n# Use the built-in parser - this requires PSv3. PSv2 has similar functionality through a different class\r\n# This captures the code definition in an object that represents how the engine parses script - an Abstract Syntax Tree\r\n#requires -Version 3\r\n[System.Management.Automation.Language.Token[]]$Tokens = @()\r\n[System.Management.Automation.Language.ParseError[]]$Errors = @()\r\n$MSScriptAst = [System.Management.Automation.Language.Parser]::ParseFile(\r\n    $MSScriptPath,\r\n    [ref]$Tokens,\r\n    [ref]$Errors\r\n)\r\n$FunctionAst = $MsScriptAst.Find({$args[0].Name -eq \"Test-ExchangeProxyLogon\"}, $false)\r\n\r\n# Now we have the definition of the useful script\r\n$FunctionDefinition = $FunctionAst.Extent.Text\r\n\r\n# Load the function definition into scope\r\n$FunctionDefinition | Invoke-Expression\r\n\r\n\r\n$MSOutput = Test-ExchangeProxyLogon\r\n```\r\n\r\nIf anyone still needs to support PSv2, ping me, I'll dig out something that'll work for your use case too.",
        "created_at": "2021-03-09T12:06:30Z",
        "html_url": "https://github.com/microsoft/CSS-Exchange/issues/108#issuecomment-793791336",
        "id": 793791336,
        "issue_url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/108",
        "node_id": "MDEyOklzc3VlQ29tbWVudDc5Mzc5MTMzNg==",
        "performed_via_github_app": null,
        "reactions": {
            "+1": 0,
            "-1": 0,
            "confused": 0,
            "eyes": 0,
            "heart": 0,
            "hooray": 0,
            "laugh": 0,
            "rocket": 0,
            "total_count": 0,
            "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/793791336/reactions"
        },
        "updated_at": "2021-03-09T12:26:42Z",
        "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/793791336",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/3678789?v=4",
            "events_url": "https://api.github.com/users/fsackur/events{/privacy}",
            "followers_url": "https://api.github.com/users/fsackur/followers",
            "following_url": "https://api.github.com/users/fsackur/following{/other_user}",
            "gists_url": "https://api.github.com/users/fsackur/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/fsackur",
            "id": 3678789,
            "login": "fsackur",
            "node_id": "MDQ6VXNlcjM2Nzg3ODk=",
            "organizations_url": "https://api.github.com/users/fsackur/orgs",
            "received_events_url": "https://api.github.com/users/fsackur/received_events",
            "repos_url": "https://api.github.com/users/fsackur/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/fsackur/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/fsackur/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/fsackur"
        }
    },
    {
        "author_association": "NONE",
        "body": "Hello everybody and thanks to all who are trying to help!!\r\n\r\nWe are running an Exchange 2010 on Server 2008 R2 Standard and we have already installed the [Update Rollup 32 (KB5000978)](https://www.microsoft.com/en-us/download/details.aspx?id=102774).\r\n\r\nWe need to run this old Exchange server for less than one year before we can move to O365.\r\n\r\nWe read this thread an understood that for Exchange 2010 the only thing to proof is this commands:\r\n\r\n`Get-EventLog -LogName Application -Source \"MSExchange Unified Messaging\" -EntryType Error | Where-Object { $_.Message -like \"*System.InvalidCastException*\" }`\r\n\r\nWhen pasting this command to the Exchange Management Shell it returns that it did not found any accordance.\r\n-----> Does that mean that our Exchange seems not to be attacked?\r\n\r\nThanks to all.\r\n",
        "created_at": "2021-03-09T13:01:25Z",
        "html_url": "https://github.com/microsoft/CSS-Exchange/issues/108#issuecomment-793868210",
        "id": 793868210,
        "issue_url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/108",
        "node_id": "MDEyOklzc3VlQ29tbWVudDc5Mzg2ODIxMA==",
        "performed_via_github_app": null,
        "reactions": {
            "+1": 0,
            "-1": 0,
            "confused": 0,
            "eyes": 0,
            "heart": 0,
            "hooray": 0,
            "laugh": 0,
            "rocket": 0,
            "total_count": 0,
            "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/793868210/reactions"
        },
        "updated_at": "2021-03-09T13:01:25Z",
        "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/793868210",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/80331005?v=4",
            "events_url": "https://api.github.com/users/wonderwilly/events{/privacy}",
            "followers_url": "https://api.github.com/users/wonderwilly/followers",
            "following_url": "https://api.github.com/users/wonderwilly/following{/other_user}",
            "gists_url": "https://api.github.com/users/wonderwilly/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/wonderwilly",
            "id": 80331005,
            "login": "wonderwilly",
            "node_id": "MDQ6VXNlcjgwMzMxMDA1",
            "organizations_url": "https://api.github.com/users/wonderwilly/orgs",
            "received_events_url": "https://api.github.com/users/wonderwilly/received_events",
            "repos_url": "https://api.github.com/users/wonderwilly/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/wonderwilly/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/wonderwilly/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/wonderwilly"
        }
    },
    {
        "author_association": "MEMBER",
        "body": "@wonderwilly That means there's no sign of CVE-2021-26857 exploitation, at least as far back as your Application log goes.",
        "created_at": "2021-03-09T13:03:50Z",
        "html_url": "https://github.com/microsoft/CSS-Exchange/issues/108#issuecomment-793871003",
        "id": 793871003,
        "issue_url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/108",
        "node_id": "MDEyOklzc3VlQ29tbWVudDc5Mzg3MTAwMw==",
        "performed_via_github_app": null,
        "reactions": {
            "+1": 0,
            "-1": 0,
            "confused": 0,
            "eyes": 0,
            "heart": 0,
            "hooray": 0,
            "laugh": 0,
            "rocket": 0,
            "total_count": 0,
            "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/793871003/reactions"
        },
        "updated_at": "2021-03-09T13:03:50Z",
        "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/793871003",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/4518572?v=4",
            "events_url": "https://api.github.com/users/bill-long/events{/privacy}",
            "followers_url": "https://api.github.com/users/bill-long/followers",
            "following_url": "https://api.github.com/users/bill-long/following{/other_user}",
            "gists_url": "https://api.github.com/users/bill-long/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/bill-long",
            "id": 4518572,
            "login": "bill-long",
            "node_id": "MDQ6VXNlcjQ1MTg1NzI=",
            "organizations_url": "https://api.github.com/users/bill-long/orgs",
            "received_events_url": "https://api.github.com/users/bill-long/received_events",
            "repos_url": "https://api.github.com/users/bill-long/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/bill-long/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bill-long/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/bill-long"
        }
    },
    {
        "author_association": "NONE",
        "body": "@bill-long Following is the resultant output. Just to confirm \"No matches found\" is the expected result for NO exploitation of CVE-2021-26857 as far back as the application log goes?\r\n\r\n[PS] C:\\Windows\\system32>Get-EventLog -LogName Application -Source \"MSExchange Unified Messaging\" -EntryType Error | Whe\r\nre-Object { $_.Message -like \"*System.InvalidCastException*\" }\r\nGet-EventLog : No matches found\r\nAt line:1 char:13\r\n+ Get-EventLog <<<<  -LogName Application -Source \"MSExchange Unified Messaging\" -EntryType Error | Where-Object { $_.M\r\nessage -like \"*System.InvalidCastException*\" }\r\n    + CategoryInfo          : ObjectNotFound: (:) [Get-EventLog], ArgumentException\r\n    + FullyQualifiedErrorId : GetEventLogNoEntriesFound,Microsoft.PowerShell.Commands.GetEventLogCommand\r\n",
        "created_at": "2021-03-09T13:15:58Z",
        "html_url": "https://github.com/microsoft/CSS-Exchange/issues/108#issuecomment-793884253",
        "id": 793884253,
        "issue_url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/108",
        "node_id": "MDEyOklzc3VlQ29tbWVudDc5Mzg4NDI1Mw==",
        "performed_via_github_app": null,
        "reactions": {
            "+1": 0,
            "-1": 0,
            "confused": 0,
            "eyes": 0,
            "heart": 0,
            "hooray": 0,
            "laugh": 0,
            "rocket": 0,
            "total_count": 0,
            "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/793884253/reactions"
        },
        "updated_at": "2021-03-09T13:15:58Z",
        "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/793884253",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/80268907?v=4",
            "events_url": "https://api.github.com/users/greenstreak20/events{/privacy}",
            "followers_url": "https://api.github.com/users/greenstreak20/followers",
            "following_url": "https://api.github.com/users/greenstreak20/following{/other_user}",
            "gists_url": "https://api.github.com/users/greenstreak20/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/greenstreak20",
            "id": 80268907,
            "login": "greenstreak20",
            "node_id": "MDQ6VXNlcjgwMjY4OTA3",
            "organizations_url": "https://api.github.com/users/greenstreak20/orgs",
            "received_events_url": "https://api.github.com/users/greenstreak20/received_events",
            "repos_url": "https://api.github.com/users/greenstreak20/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/greenstreak20/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/greenstreak20/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/greenstreak20"
        }
    },
    {
        "author_association": "MEMBER",
        "body": "@fsackur If you're not on at least Powershell 4, I assume that means you're on Exchange 2010? In which case, why not just run the event log search, which does already return objects? That's the only test that applies to 2010. Or am I misunderstanding the use case?\r\n\r\nAnd yeah, as you can see by the code, we initially had the script returning objects, but due to the friction with users who don't really PowerShell, we compromised and made it work like a normal script. With some minor modifications you can then dot-source it and call Test-ExchangeProxyLogon directly. Can you point me to an example script where the inner cmdlets are exportable while you can still use it as a script?",
        "created_at": "2021-03-09T13:23:50Z",
        "html_url": "https://github.com/microsoft/CSS-Exchange/issues/108#issuecomment-793893294",
        "id": 793893294,
        "issue_url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/108",
        "node_id": "MDEyOklzc3VlQ29tbWVudDc5Mzg5MzI5NA==",
        "performed_via_github_app": null,
        "reactions": {
            "+1": 0,
            "-1": 0,
            "confused": 0,
            "eyes": 0,
            "heart": 0,
            "hooray": 0,
            "laugh": 0,
            "rocket": 0,
            "total_count": 0,
            "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/793893294/reactions"
        },
        "updated_at": "2021-03-09T13:23:50Z",
        "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/793893294",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/4518572?v=4",
            "events_url": "https://api.github.com/users/bill-long/events{/privacy}",
            "followers_url": "https://api.github.com/users/bill-long/followers",
            "following_url": "https://api.github.com/users/bill-long/following{/other_user}",
            "gists_url": "https://api.github.com/users/bill-long/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/bill-long",
            "id": 4518572,
            "login": "bill-long",
            "node_id": "MDQ6VXNlcjQ1MTg1NzI=",
            "organizations_url": "https://api.github.com/users/bill-long/orgs",
            "received_events_url": "https://api.github.com/users/bill-long/received_events",
            "repos_url": "https://api.github.com/users/bill-long/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/bill-long/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bill-long/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/bill-long"
        }
    },
    {
        "author_association": "MEMBER",
        "body": "@greenstreak20 Correct. It's annoying that it throws an error like something went wrong, but that's the normal result of finding no matches.\r\n\r\nEdit: You can add -ErrorAction SilentlyContinue to the Get-EventLog command to suppress the error. If you're on a system that supports Get-WinEvent, you can copy/paste the command from the script, which is a bit faster than Get-EventLog.",
        "created_at": "2021-03-09T13:28:19Z",
        "html_url": "https://github.com/microsoft/CSS-Exchange/issues/108#issuecomment-793898348",
        "id": 793898348,
        "issue_url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/108",
        "node_id": "MDEyOklzc3VlQ29tbWVudDc5Mzg5ODM0OA==",
        "performed_via_github_app": null,
        "reactions": {
            "+1": 0,
            "-1": 0,
            "confused": 0,
            "eyes": 0,
            "heart": 0,
            "hooray": 0,
            "laugh": 0,
            "rocket": 0,
            "total_count": 0,
            "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/793898348/reactions"
        },
        "updated_at": "2021-03-09T13:30:03Z",
        "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/793898348",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/4518572?v=4",
            "events_url": "https://api.github.com/users/bill-long/events{/privacy}",
            "followers_url": "https://api.github.com/users/bill-long/followers",
            "following_url": "https://api.github.com/users/bill-long/following{/other_user}",
            "gists_url": "https://api.github.com/users/bill-long/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/bill-long",
            "id": 4518572,
            "login": "bill-long",
            "node_id": "MDQ6VXNlcjQ1MTg1NzI=",
            "organizations_url": "https://api.github.com/users/bill-long/orgs",
            "received_events_url": "https://api.github.com/users/bill-long/received_events",
            "repos_url": "https://api.github.com/users/bill-long/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/bill-long/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bill-long/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/bill-long"
        }
    },
    {
        "author_association": "NONE",
        "body": "Thank you @bill-long !!\r\n\r\n> @wonderwilly That means there's no sign of CVE-2021-26857 exploitation, at least as far back as your Application log goes.\r\n\r\nWhen filtering the Windows servers event log for Exchange, the logs go back to 2014 when the server was installed. Seems the logs were never been deletet/cleared.\r\n\r\nShould/could we do any thing more to proof for already happend infiltrations?\r\n\r\nAnd could we do anything more than installing the MS update rollup 32? For example create some firewall blocks for certain (source) IPs and ports?",
        "created_at": "2021-03-09T13:35:05Z",
        "html_url": "https://github.com/microsoft/CSS-Exchange/issues/108#issuecomment-793906253",
        "id": 793906253,
        "issue_url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/108",
        "node_id": "MDEyOklzc3VlQ29tbWVudDc5MzkwNjI1Mw==",
        "performed_via_github_app": null,
        "reactions": {
            "+1": 0,
            "-1": 0,
            "confused": 0,
            "eyes": 0,
            "heart": 0,
            "hooray": 0,
            "laugh": 0,
            "rocket": 0,
            "total_count": 0,
            "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/793906253/reactions"
        },
        "updated_at": "2021-03-09T13:35:05Z",
        "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/793906253",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/80331005?v=4",
            "events_url": "https://api.github.com/users/wonderwilly/events{/privacy}",
            "followers_url": "https://api.github.com/users/wonderwilly/followers",
            "following_url": "https://api.github.com/users/wonderwilly/following{/other_user}",
            "gists_url": "https://api.github.com/users/wonderwilly/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/wonderwilly",
            "id": 80331005,
            "login": "wonderwilly",
            "node_id": "MDQ6VXNlcjgwMzMxMDA1",
            "organizations_url": "https://api.github.com/users/wonderwilly/orgs",
            "received_events_url": "https://api.github.com/users/wonderwilly/received_events",
            "repos_url": "https://api.github.com/users/wonderwilly/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/wonderwilly/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/wonderwilly/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/wonderwilly"
        }
    },
    {
        "author_association": "NONE",
        "body": "@bill-long Thanks! I appreciate all your efforts and support. ",
        "created_at": "2021-03-09T13:44:00Z",
        "html_url": "https://github.com/microsoft/CSS-Exchange/issues/108#issuecomment-793916649",
        "id": 793916649,
        "issue_url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/108",
        "node_id": "MDEyOklzc3VlQ29tbWVudDc5MzkxNjY0OQ==",
        "performed_via_github_app": null,
        "reactions": {
            "+1": 0,
            "-1": 0,
            "confused": 0,
            "eyes": 0,
            "heart": 0,
            "hooray": 0,
            "laugh": 0,
            "rocket": 0,
            "total_count": 0,
            "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/793916649/reactions"
        },
        "updated_at": "2021-03-09T13:44:00Z",
        "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/793916649",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/80268907?v=4",
            "events_url": "https://api.github.com/users/greenstreak20/events{/privacy}",
            "followers_url": "https://api.github.com/users/greenstreak20/followers",
            "following_url": "https://api.github.com/users/greenstreak20/following{/other_user}",
            "gists_url": "https://api.github.com/users/greenstreak20/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/greenstreak20",
            "id": 80268907,
            "login": "greenstreak20",
            "node_id": "MDQ6VXNlcjgwMjY4OTA3",
            "organizations_url": "https://api.github.com/users/greenstreak20/orgs",
            "received_events_url": "https://api.github.com/users/greenstreak20/received_events",
            "repos_url": "https://api.github.com/users/greenstreak20/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/greenstreak20/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/greenstreak20/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/greenstreak20"
        }
    },
    {
        "author_association": "NONE",
        "body": "Re PS version:\r\n\r\n@bill-long your question highlights my lack of product knowledge - I'm going off what the exchange team told me, but that was a metting with the managers, not the engineers!\r\n\r\nI value having a universal entrypoint across versions. There's at least some SBS 2011 in our fleet, and my dataset is imperfect. It's a big timesaver to run the same tooling and just get the results.\r\n\r\nTo keep perspective: worrying about the finer points of PS versions is not the main issue this week! I'm OK if I've logged the comment and it is not addressed. The AST snippet I commented is one of several possible workarounds.\r\n\r\nIf you like though, my offer still stands to do a PR that replaces the hard `#requires` with a function body test for the problematic line.",
        "created_at": "2021-03-09T13:46:31Z",
        "html_url": "https://github.com/microsoft/CSS-Exchange/issues/108#issuecomment-793919556",
        "id": 793919556,
        "issue_url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/108",
        "node_id": "MDEyOklzc3VlQ29tbWVudDc5MzkxOTU1Ng==",
        "performed_via_github_app": null,
        "reactions": {
            "+1": 0,
            "-1": 0,
            "confused": 0,
            "eyes": 0,
            "heart": 0,
            "hooray": 0,
            "laugh": 0,
            "rocket": 0,
            "total_count": 0,
            "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/793919556/reactions"
        },
        "updated_at": "2021-03-09T13:46:31Z",
        "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/793919556",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/3678789?v=4",
            "events_url": "https://api.github.com/users/fsackur/events{/privacy}",
            "followers_url": "https://api.github.com/users/fsackur/followers",
            "following_url": "https://api.github.com/users/fsackur/following{/other_user}",
            "gists_url": "https://api.github.com/users/fsackur/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/fsackur",
            "id": 3678789,
            "login": "fsackur",
            "node_id": "MDQ6VXNlcjM2Nzg3ODk=",
            "organizations_url": "https://api.github.com/users/fsackur/orgs",
            "received_events_url": "https://api.github.com/users/fsackur/received_events",
            "repos_url": "https://api.github.com/users/fsackur/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/fsackur/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/fsackur/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/fsackur"
        }
    },
    {
        "author_association": "NONE",
        "body": "Re export, here's a possibility, let me know if you'd liek this rpesented as a PR:\r\n\r\n```powershell\r\n\r\n[CmdletBinding(DefaultParameterSetName = 'AsScript')]\r\nparam (\r\n    [Parameter(ParameterSetName = 'AsScript', ValueFromPipeline = $true, ValueFromPipelineByPropertyName = $true)]\r\n    [string[]]\r\n    $ComputerName,\r\n\r\n    # ...OutPath and DisplayOnly also set to AsScript paramset\r\n\r\n    [Parameter(ParameterSetName = 'AsModule')]\r\n    [switch]\r\n    $Export     # Possible to inspect call stack and set this automatically if user ran Import-Module... perhaps\r\n)\r\n\r\nprocess {\r\n\r\n    function Test-ExchangeProxyLogon {\r\n        # ...etc...\r\n    }\r\n\r\n    function Write-ProxyLogonReport {\r\n        # ...etc...\r\n    }\r\n\r\n    if ($Export)\r\n    {\r\n        Set-Item function:global:Test-ExchangeProxyLogon (Get-Command Test-ExchangeProxyLogon)\r\n        Set-Item function:global:Write-ProxyLogonReport (Get-Command Write-ProxyLogonReport)\r\n    }\r\n    else\r\n    {\r\n        if ($DisplayOnly) {\r\n            # ...etc...\r\n        }\r\n    }\r\n}\r\n```\r\n\r\nIn use:\r\n\r\n```\r\nC:\\githubdata\\microsoft-CSS-Exchange  main \u21e3 13* ?1 \r\n\u276f gcm *proxylogon*\r\n\r\nC:\\githubdata\\microsoft-CSS-Exchange  main \u21e3 13* ?1 \r\n\u276f .\\Security\\Untitled-1.ps1 -Export\r\n\r\nC:\\githubdata\\microsoft-CSS-Exchange  main \u21e3 13* ?1 \r\n\u276f gcm *proxylogon*\r\n\r\nCommandType     Name                                               Version    Source\r\n-----------     ----                                               -------    ------\r\nFunction        Test-ExchangeProxyLogon\r\nFunction        Write-ProxyLogonReport\r\n```\r\n\r\nIf we did this, I could drop the AST hack",
        "created_at": "2021-03-09T13:47:22Z",
        "html_url": "https://github.com/microsoft/CSS-Exchange/issues/108#issuecomment-793920554",
        "id": 793920554,
        "issue_url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/108",
        "node_id": "MDEyOklzc3VlQ29tbWVudDc5MzkyMDU1NA==",
        "performed_via_github_app": null,
        "reactions": {
            "+1": 0,
            "-1": 0,
            "confused": 0,
            "eyes": 0,
            "heart": 0,
            "hooray": 0,
            "laugh": 0,
            "rocket": 0,
            "total_count": 0,
            "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/793920554/reactions"
        },
        "updated_at": "2021-03-09T13:48:10Z",
        "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/793920554",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/3678789?v=4",
            "events_url": "https://api.github.com/users/fsackur/events{/privacy}",
            "followers_url": "https://api.github.com/users/fsackur/followers",
            "following_url": "https://api.github.com/users/fsackur/following{/other_user}",
            "gists_url": "https://api.github.com/users/fsackur/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/fsackur",
            "id": 3678789,
            "login": "fsackur",
            "node_id": "MDQ6VXNlcjM2Nzg3ODk=",
            "organizations_url": "https://api.github.com/users/fsackur/orgs",
            "received_events_url": "https://api.github.com/users/fsackur/received_events",
            "repos_url": "https://api.github.com/users/fsackur/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/fsackur/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/fsackur/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/fsackur"
        }
    },
    {
        "author_association": "MEMBER",
        "body": "I love that approach. I'll experiment with it today.",
        "created_at": "2021-03-09T15:05:39Z",
        "html_url": "https://github.com/microsoft/CSS-Exchange/issues/108#issuecomment-794017974",
        "id": 794017974,
        "issue_url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/108",
        "node_id": "MDEyOklzc3VlQ29tbWVudDc5NDAxNzk3NA==",
        "performed_via_github_app": null,
        "reactions": {
            "+1": 0,
            "-1": 0,
            "confused": 0,
            "eyes": 0,
            "heart": 0,
            "hooray": 0,
            "laugh": 0,
            "rocket": 0,
            "total_count": 0,
            "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/794017974/reactions"
        },
        "updated_at": "2021-03-09T15:05:39Z",
        "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/794017974",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/4518572?v=4",
            "events_url": "https://api.github.com/users/bill-long/events{/privacy}",
            "followers_url": "https://api.github.com/users/bill-long/followers",
            "following_url": "https://api.github.com/users/bill-long/following{/other_user}",
            "gists_url": "https://api.github.com/users/bill-long/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/bill-long",
            "id": 4518572,
            "login": "bill-long",
            "node_id": "MDQ6VXNlcjQ1MTg1NzI=",
            "organizations_url": "https://api.github.com/users/bill-long/orgs",
            "received_events_url": "https://api.github.com/users/bill-long/received_events",
            "repos_url": "https://api.github.com/users/bill-long/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/bill-long/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bill-long/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/bill-long"
        }
    },
    {
        "author_association": "MEMBER",
        "body": "This is in the release that just went up. Note:\r\n\r\n* Version requirement dropped to 3.\r\n* We now refer to PSCredential by its full name. This is supposed to work in older versions of PowerShell, but I can't test it myself.\r\n* You can export the functions as shown above.\r\n\r\nHowever, there is a breaking change for anyone who was using the functions directly already. The shape of the Cve26855 report object has changed. It now contains two things:\r\n\r\nHits - contains the old data, just the hits from the files.\r\nFileList - full name of files containing hits, for collection or further investigation.",
        "created_at": "2021-03-09T18:27:36Z",
        "html_url": "https://github.com/microsoft/CSS-Exchange/issues/108#issuecomment-794272165",
        "id": 794272165,
        "issue_url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/108",
        "node_id": "MDEyOklzc3VlQ29tbWVudDc5NDI3MjE2NQ==",
        "performed_via_github_app": null,
        "reactions": {
            "+1": 0,
            "-1": 0,
            "confused": 0,
            "eyes": 0,
            "heart": 1,
            "hooray": 0,
            "laugh": 0,
            "rocket": 0,
            "total_count": 1,
            "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/794272165/reactions"
        },
        "updated_at": "2021-03-09T18:27:36Z",
        "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/794272165",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/4518572?v=4",
            "events_url": "https://api.github.com/users/bill-long/events{/privacy}",
            "followers_url": "https://api.github.com/users/bill-long/followers",
            "following_url": "https://api.github.com/users/bill-long/following{/other_user}",
            "gists_url": "https://api.github.com/users/bill-long/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/bill-long",
            "id": 4518572,
            "login": "bill-long",
            "node_id": "MDQ6VXNlcjQ1MTg1NzI=",
            "organizations_url": "https://api.github.com/users/bill-long/orgs",
            "received_events_url": "https://api.github.com/users/bill-long/received_events",
            "repos_url": "https://api.github.com/users/bill-long/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/bill-long/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bill-long/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/bill-long"
        }
    },
    {
        "author_association": "NONE",
        "body": "> Another option is to run the blog commands manually on 2010.\r\n\r\nWhich blog? https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/ ?",
        "created_at": "2021-03-19T19:59:16Z",
        "html_url": "https://github.com/microsoft/CSS-Exchange/issues/108#issuecomment-803084277",
        "id": 803084277,
        "issue_url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/108",
        "node_id": "MDEyOklzc3VlQ29tbWVudDgwMzA4NDI3Nw==",
        "performed_via_github_app": null,
        "reactions": {
            "+1": 0,
            "-1": 0,
            "confused": 0,
            "eyes": 0,
            "heart": 0,
            "hooray": 0,
            "laugh": 0,
            "rocket": 0,
            "total_count": 0,
            "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/803084277/reactions"
        },
        "updated_at": "2021-03-19T20:07:18Z",
        "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/803084277",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/515451?v=4",
            "events_url": "https://api.github.com/users/ProBackup-nl/events{/privacy}",
            "followers_url": "https://api.github.com/users/ProBackup-nl/followers",
            "following_url": "https://api.github.com/users/ProBackup-nl/following{/other_user}",
            "gists_url": "https://api.github.com/users/ProBackup-nl/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/ProBackup-nl",
            "id": 515451,
            "login": "ProBackup-nl",
            "node_id": "MDQ6VXNlcjUxNTQ1MQ==",
            "organizations_url": "https://api.github.com/users/ProBackup-nl/orgs",
            "received_events_url": "https://api.github.com/users/ProBackup-nl/received_events",
            "repos_url": "https://api.github.com/users/ProBackup-nl/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/ProBackup-nl/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/ProBackup-nl/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/ProBackup-nl"
        }
    },
    {
        "author_association": "MEMBER",
        "body": "@ProBackup-nl All the tests in this script are based on this blog post:\r\n\r\nhttps://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/\r\n\r\nOf the four vulnerabilities mentioned there, only CVE-2021-26857 applies to Exchange 2010. The command the blog shows to check for evidence of exploitation of that vulnerability is:\r\n\r\n`Get-EventLog -LogName Application -Source \"MSExchange Unified Messaging\" -EntryType Error | Where-Object { $_.Message -like \"*System.InvalidCastException*\" }`\r\n\r\n",
        "created_at": "2021-03-19T20:07:42Z",
        "html_url": "https://github.com/microsoft/CSS-Exchange/issues/108#issuecomment-803090506",
        "id": 803090506,
        "issue_url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/108",
        "node_id": "MDEyOklzc3VlQ29tbWVudDgwMzA5MDUwNg==",
        "performed_via_github_app": null,
        "reactions": {
            "+1": 1,
            "-1": 0,
            "confused": 0,
            "eyes": 0,
            "heart": 0,
            "hooray": 0,
            "laugh": 0,
            "rocket": 0,
            "total_count": 1,
            "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/803090506/reactions"
        },
        "updated_at": "2021-03-19T20:07:42Z",
        "url": "https://api.github.com/repos/microsoft/CSS-Exchange/issues/comments/803090506",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/4518572?v=4",
            "events_url": "https://api.github.com/users/bill-long/events{/privacy}",
            "followers_url": "https://api.github.com/users/bill-long/followers",
            "following_url": "https://api.github.com/users/bill-long/following{/other_user}",
            "gists_url": "https://api.github.com/users/bill-long/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/bill-long",
            "id": 4518572,
            "login": "bill-long",
            "node_id": "MDQ6VXNlcjQ1MTg1NzI=",
            "organizations_url": "https://api.github.com/users/bill-long/orgs",
            "received_events_url": "https://api.github.com/users/bill-long/received_events",
            "repos_url": "https://api.github.com/users/bill-long/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/bill-long/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bill-long/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/bill-long"
        }
    }
]