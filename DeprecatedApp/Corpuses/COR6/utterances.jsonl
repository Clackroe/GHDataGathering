{"id": "ROOT", "speaker": "amorenew", "conversation_id": "ROOT", "reply_to": "ROOT", "timestamp": "2019-12-12T19:30:24Z", "text": "Disable Origin Policy CORS in Flutter web ## Use case\r \r While calling a web service on Flutter web it will not work because of CORS Policy\r \r ## Proposal\r I saw a chrome window when I start debugging a Flutter web application\r I wonder if we could add a flag to disable the CORS policy\r like `Flutter run -d web --no-cors`\r \r `chromium-browser --disable-web-security --user-data-dir=\"[some directory here]\"\r `\r https://stackoverflow.com/questions/3102819/disable-same-origin-policy-in-chrome\r ", "meta": {"posReactions": "49", "negReactions": "0"}}
{"id": "COM0", "speaker": "jonahwilliams", "conversation_id": "ROOT", "reply_to": "ROOT", "timestamp": "2019-12-12T20:41:16Z", "text": "Disabling the CORS checks locally would lead to drastically different behavior between a debug and deployed application - you can't very well ask all users of your website to disable CORS locally. Adding this flag would be a mistake", "meta": {"posReactions": "2", "negReactions": "39"}}
{"id": "COM1", "speaker": "amorenew", "conversation_id": "ROOT", "reply_to": "COM0", "timestamp": "2019-12-13T06:47:07Z", "text": "@jonahwilliams I wonder why web services work in Android debugging mode while there is no Internet permission in the Manifest file?\r\n<uses-permission android:name=\"android.permission.INTERNET\"/>\r\n\r\nFor sure the simple answer is easy debugging until adding the permission for the release version", "meta": {"posReactions": "3", "negReactions": "0"}}
{"id": "COM2", "speaker": "amorenew", "conversation_id": "ROOT", "reply_to": "COM1", "timestamp": "2019-12-13T06:51:26Z", "text": "Internet Permission for Android is the same as CORS in Chrome\r\nHere is the PR for Android Permission that makes Internet works debug mode only\r\n\r\n`This is not an \"injection\" at build time, but rather a separate manifest for debug builds\r\n`\r\nDebug mode Internet permission PR\r\n**move INTERNET permission to debug/AndroidManifest.xml**\r\nhttps://github.com/flutter/flutter/pull/22139\r\nProfile mode Internet permission PR\r\n**Add a manifest for profile builds that enables INTERNET permission**\r\nhttps://github.com/flutter/flutter/pull/26450\r\n\r\n> Adding this flag would be a mistake\r\n\r\nIt will be **optional** `-flag` only until the backend developer add whitelist for my local or in AWS config", "meta": {"posReactions": "9", "negReactions": "0"}}
{"id": "COM3", "speaker": "jonahwilliams", "conversation_id": "ROOT", "reply_to": "COM2", "timestamp": "2019-12-13T08:03:22Z", "text": "> Internet Permission for Android is the same as CORS in Chrome\r\n\r\nIt is absolutely not the same thing", "meta": {"posReactions": "0", "negReactions": "2"}}
{"id": "COM4", "speaker": "krunaldarji", "conversation_id": "ROOT", "reply_to": "COM3", "timestamp": "2019-12-15T17:15:35Z", "text": "@amreniouinnovent flutter web working locally and remotely ? I am also facing this issue with flutter web but it works fine on Mobile \r\n\r\n@jonahwilliams this is a bug in Flutter web ?", "meta": {"posReactions": "0", "negReactions": "0"}}
{"id": "COM5", "speaker": "amorenew", "conversation_id": "ROOT", "reply_to": "COM4", "timestamp": "2019-12-15T18:10:46Z", "text": "@krunaldarji it is not a bug. it is security permission like when you call twitter from facebook then facebook is not allowed to call twitter.\r\nSo backend developer should allow you to call his web service from your localhost.\r\nthis security feature is for browsers only but not on mobile or postman. \r\n", "meta": {"posReactions": "0", "negReactions": "0"}}
{"id": "COM6", "speaker": "amreniouinnovent", "conversation_id": "ROOT", "reply_to": "COM5", "timestamp": "2019-12-16T06:09:16Z", "text": "@jonahwilliams developers suggested using an extension or opening chrome with CORS disabled\r\nSo I have 2 questions:\r\n\r\n1- Why the app is not launching as a new tab in the same browser? and is there any possibility I can change the default behavior? because the chrome instance which got launched doesn't have extensions like my default chrome.\r\n\r\n2-How could I configure the app to run on Firefox instead of chrome?", "meta": {"posReactions": "8", "negReactions": "0"}}
{"id": "COM7", "speaker": "krunaldarji", "conversation_id": "ROOT", "reply_to": "COM6", "timestamp": "2019-12-20T19:47:44Z", "text": "@amorenew But i hosted my website on Firebase also but still same problem any idea ? Or how to allow this api call from my localhost because i am using few microsoft sharepoint api's which i can't request Microsoft for modification.\r\n\r\nPls help.", "meta": {"posReactions": "0", "negReactions": "0"}}
{"id": "COM8", "speaker": "MOlechowski", "conversation_id": "ROOT", "reply_to": "COM7", "timestamp": "2019-12-21T00:41:34Z", "text": "You can start flutter web server on random port using command flutter run -d web-server, and then go to localhost:port in your browser or you could use release app using following guide https://flutter.dev/docs/deployment/web", "meta": {"posReactions": "0", "negReactions": "0"}}
{"id": "COM9", "speaker": "krunaldarji", "conversation_id": "ROOT", "reply_to": "COM8", "timestamp": "2019-12-21T06:13:52Z", "text": "@MOlechowski Thanks for your response but its giving below error: \r\nAccess to XMLHttpRequest at 'https://login.microsoftonline.com/2a1c1526-05d412fa/oauth2/v2.0/token' from origin 'http://localhost:49948' has been blocked by CORS policy: No 'Access-Control-Allow-Origin' header is present on the requested resource.", "meta": {"posReactions": "0", "negReactions": "0"}}
{"id": "COM10", "speaker": "amreniouinnovent", "conversation_id": "ROOT", "reply_to": "COM9", "timestamp": "2019-12-22T06:56:55Z", "text": "@krunaldarji In AWS you could whitelist a specific port\r\nSo I am sure Sharepoint has the same feature\r\nBy the way, you can Add the whitelisted port for every run in the launch.json file\r\n```\r\n\"configurations\": \r\n[{\"name\": \"Flutter\",\r\n\"request\": \"launch\",\r\n\"type\": \"dart\",\r\n\"args\": [\"--web-port\",\"8080\"]\r\n}]\r\n\r\n```\r\n\r\nSharepoint CORS https://techcommunity.microsoft.com/t5/SharePoint-Developer/SharePoint-Office-365-CORS-issue-REST-API-call-to-other/m-p/777557", "meta": {"posReactions": "0", "negReactions": "0"}}
{"id": "COM11", "speaker": "MohsinKhanSerpro", "conversation_id": "ROOT", "reply_to": "COM10", "timestamp": "2020-04-28T09:09:14Z", "text": "Hi team\r\nI am facing this CORS policy issue from last 2 month, still not able to figure it out how to fix\r\n\r\n`Access to XMLHttpRequest at 'http://obuat-env.zuriwydraq.ap-south-1.elasticbeanstalk.com/api/v1/RegisterDevice' from origin 'http://35.154.115.156' has been blocked by CORS policy: Response to preflight request doesn't pass access control check: It does not have HTTP ok status.`\r\n\r\n- I have hosted my flutter web app on AWS - Apache environment\r\n\r\nplease if you any solution please help me.", "meta": {"posReactions": "2", "negReactions": "0"}}
{"id": "COM12", "speaker": "deakjahn", "conversation_id": "ROOT", "reply_to": "COM11", "timestamp": "2020-05-15T16:43:54Z", "text": "The solution: create a batch file (or whatever your platform calls the shell scripts) that calls Chrome with the appropriate command line:\r\n\r\n    \"c:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe\" --disable-web-security --user-data-dir=\"a-temp-location\" %*\r\n\r\n(Note the `%*` at the end, important!) Set up an environment variable named `CHROME_EXECUTABLE` to point to this file. Flutter will then use this file to start Chrome.", "meta": {"posReactions": "0", "negReactions": "0"}}
{"id": "COM13", "speaker": "amorenew", "conversation_id": "ROOT", "reply_to": "COM12", "timestamp": "2020-05-15T19:52:09Z", "text": "@deakjahn \r\nHow flutter will use it? is it automatically?\r\n> Flutter will then use this file to start Chrome.\r\n\r\n", "meta": {"posReactions": "0", "negReactions": "0"}}
{"id": "COM14", "speaker": "deakjahn", "conversation_id": "ROOT", "reply_to": "COM13", "timestamp": "2020-05-15T22:10:52Z", "text": "Yes. Flutter checks this env variable before it launches Chrome. If you try to start `flutter run -d chrome` on a system that doesn't have Chrome installed, Flutter will specifically ask you to either put it into the default location or to tell it where it is using `CHROME_EXECUTABLE` (this is actually how I learned of its existence :-) ).", "meta": {"posReactions": "0", "negReactions": "0"}}
{"id": "COM15", "speaker": "BesartLaci", "conversation_id": "ROOT", "reply_to": "COM14", "timestamp": "2020-05-16T16:36:13Z", "text": "@deakjahn your [script solution](https://github.com/flutter/flutter/issues/46904#issuecomment-629363145) workes like a charm \ud83d\udc4d ", "meta": {"posReactions": "0", "negReactions": "0"}}
{"id": "COM16", "speaker": "vyvee", "conversation_id": "ROOT", "reply_to": "COM15", "timestamp": "2020-05-20T05:36:28Z", "text": "@deakjahn Thanks! I have adapted your [script solution](https://github.com/flutter/flutter/issues/46904#issuecomment-629363145) in Linux as described below and it works perfectly!\r\n\r\nCreate a `google-chrome-unsafe.sh` with the following content:\r\n\r\n    #!/bin/sh\r\n    /usr/bin/google-chrome-stable --disable-web-security --user-data-dir=\"A-TEMP-LOCATION\" $*\r\n\r\nIt's better to create and use a dedicated folder in the home directory instead of `/tmp` for the temporary location, as Chrome will create some folders there to work properly.\r\n\r\nThen, make it executable with `chmod a+x google-chrome-unsafe.sh`\r\n\r\nThe environment variable can be set in `~/.bashrc` or `~/.bash_aliases` (if included from `.bashrc`):\r\n`export CHROME_EXECUTABLE=/path/to/google-chrome-unsafe.sh`", "meta": {"posReactions": "0", "negReactions": "0"}}
{"id": "COM17", "speaker": "JaiMistry", "conversation_id": "ROOT", "reply_to": "COM16", "timestamp": "2020-05-26T05:37:55Z", "text": "@deakjahn\r\n> Yes. Flutter checks this env variable before it launches Chrome. If you try to start `flutter run -d chrome` on a system that doesn't have Chrome installed, Flutter will specifically ask you to either put it into the default location or to tell it where it is using `CHROME_EXECUTABLE` (this is actually how I learned of its existence :-) ).\r\n\r\nDo I set the `User` or `System` environment variable to `CHROME_EXECUTABLE`? I tried both and running my web application with `flutter run -d chrome` still resulted in a CORS error.", "meta": {"posReactions": "0", "negReactions": "0"}}
{"id": "COM18", "speaker": "deakjahn", "conversation_id": "ROOT", "reply_to": "COM17", "timestamp": "2020-05-26T07:06:19Z", "text": "I have it in System but it shouldn't actually matter. The Flutter doctor display shows the value when it sees it, try that first.", "meta": {"posReactions": "0", "negReactions": "0"}}
{"id": "COM19", "speaker": "devDeejay", "conversation_id": "ROOT", "reply_to": "COM18", "timestamp": "2020-05-29T09:53:54Z", "text": "So disabling CORS in Chrome on my development machine will fix it, but once deployed release mode in production the user's wont face any CORS issue?", "meta": {"posReactions": "0", "negReactions": "0"}}
{"id": "COM20", "speaker": "deakjahn", "conversation_id": "ROOT", "reply_to": "COM19", "timestamp": "2020-05-29T15:25:16Z", "text": "They will, unless you setup your servers properly. This is something you can't skip.", "meta": {"posReactions": "0", "negReactions": "2"}}
{"id": "COM21", "speaker": "jaggzh", "conversation_id": "ROOT", "reply_to": "COM20", "timestamp": "2020-05-29T17:38:52Z", "text": "Would it help if we had \"flutter -d web-server\" accept additional headers, like:\r\n  ````--web-header \"Access-Control-Allow-Origin: my-ip-here\"````\r\nEdit: It appears more might be needed, but I'm inexperienced in this. The server currently sends out some other headers that would probably also need to be modified:\r\n```HTTP/1.1 200 OK\r\ndate: Fri, 29 May 2020 18:09:01 GMT\r\ncontent-length: 1124\r\nx-frame-options: SAMEORIGIN\r\ncontent-type: text/html\r\nx-xss-protection: 1; mode=block\r\nx-content-type-options: nosniff\r\nserver: dart:io with Shelf```\r\n", "meta": {"posReactions": "1", "negReactions": "0"}}
{"id": "COM22", "speaker": "jaggzh", "conversation_id": "ROOT", "reply_to": "COM21", "timestamp": "2020-05-29T21:51:41Z", "text": "Why is this closed anyway?  Is there some solution I'm missing?\r\nI ended up setting up a reverse proxy script to modify traffic headers (the flutter host/port are hard-coded near the top of the script).\r\n(The script is from somewhere else on the web, but I modified it for py3.x and had to make some other changes to get it working.)\r\nYou run this, it'll transparently transfer your traffic from port 9000, to 8989 where I have flutter running, removing the origin headers (and some other stuff the original script stripped), and adding in the access-control-allow-origin header.\r\nThis worked for me, although I'm getting some infinite \"font\" declaration dropped errors now.  Script below that screenshot.\r\n![image](https://user-images.githubusercontent.com/20318973/83308738-50381e00-a1bc-11ea-8a17-6eede7106b5d.png)\r\n\r\n```\r\n#!/usr/bin/env python\r\n\r\nfrom http.server import BaseHTTPRequestHandler, HTTPServer\r\nimport argparse\r\nimport os\r\nimport random\r\nimport sys\r\nimport requests\r\n\r\nhostname = \"0.0.0.0\";\r\nhostport = \"8989\";\r\n\r\ndef merge_two_dicts(x, y):\r\n    z = x.copy()   # start with x's keys and values\r\n    z.update(y)    # modifies z with y's keys and values & returns None\r\n    return z\r\n\r\ndef set_header():\r\n    headers = {\r\n        'Meow': hostname\r\n    }\r\n    return headers\r\n\r\nclass ProxyHTTPRequestHandler(BaseHTTPRequestHandler):\r\n    protocol_version = 'HTTP/1.0'\r\n    def do_HEAD(self):\r\n        self.do_GET(body=False)\r\n\r\n    def do_GET(self, body=True):\r\n        sent = False\r\n        try:\r\n\r\n            url = 'http://{}:{}{}'.format(hostname, hostport, self.path)\r\n            req_header = self.parse_headers()\r\n\r\n            print(req_header)\r\n            print(url)\r\n            resp = requests.get(url, headers=merge_two_dicts(req_header, set_header()), verify=False)\r\n            sent = True\r\n\r\n            self.send_response(resp.status_code)\r\n            self.send_resp_headers(resp)\r\n            if body:\r\n                self.wfile.write(resp.content)\r\n            return\r\n        finally:\r\n            self.finish()\r\n            if not sent:\r\n                self.send_error(404, 'error trying to proxy')\r\n\r\n    def do_POST(self, body=True):\r\n        sent = False\r\n        try:\r\n            url = 'http://{}:{}{}'.format(hostname, hostport, self.path)\r\n            content_len = int(self.headers.getheader('content-length', 0))\r\n            post_body = self.rfile.read(content_len)\r\n            req_header = self.parse_headers()\r\n\r\n            resp = requests.post(url, data=post_body, headers=merge_two_dicts(req_header, set_header()), verify=False)\r\n            sent = True\r\n\r\n            self.send_response(resp.status_code)\r\n            self.send_resp_headers(resp)\r\n            if body:\r\n                self.wfile.write(resp.content)\r\n            return\r\n        finally:\r\n            self.finish()\r\n            if not sent:\r\n                self.send_error(404, 'error trying to proxy')\r\n\r\n    def parse_headers(self):\r\n        req_header = {}\r\n        for line in self.headers:\r\n            line_parts = [o.strip() for o in line.split(':', 1)]\r\n            if len(line_parts) == 2:\r\n                req_header[line_parts[0]] = line_parts[1]\r\n        return req_header\r\n\r\n    def send_resp_headers(self, resp):\r\n        respheaders = resp.headers\r\n        print('Response Header')\r\n        for key in respheaders:\r\n            if key not in [\r\n                           'Content-Encoding',\r\n                           'Transfer-Encoding',\r\n                           'content-encoding',\r\n                           'transfer-encoding',\r\n                           'content-length',\r\n                           'Content-Length',\r\n                           'x-frame-options',\r\n                           'x-xss-protection',\r\n                           'x-content-type-options',\r\n                           ]:\r\n                print(key, respheaders[key])\r\n                self.send_header(key, respheaders[key])\r\n                # Response Header\r\n                # date Fri, 29 May 2020 18:35:40 GMT\r\n                # x-frame-options SAMEORIGIN\r\n                # content-type text/html\r\n                # x-xss-protection 1; mode=block\r\n                # x-content-type-options nosniff\r\n                # server dart:io with Shelf\r\n        self.send_header('Access-Control-Allow-Origin', '*')\r\n        self.send_header('Content-Length', len(resp.content))\r\n        self.end_headers()\r\n\r\n\r\ndef parse_args(argv=sys.argv[1:]):\r\n    parser = argparse.ArgumentParser(description='Proxy HTTP requests')\r\n    parser.add_argument('--port', dest='port', type=int, default=9000,\r\n                        help='serve HTTP requests on specified port (default: 9000)')\r\n    args = parser.parse_args(argv)\r\n    return args\r\n\r\ndef main(argv=sys.argv[1:]):\r\n    args = parse_args(argv)\r\n    print('http server is starting on port {}...'.format(args.port))\r\n    server_address = ('0.0.0.0', args.port)\r\n    httpd = HTTPServer(server_address, ProxyHTTPRequestHandler)\r\n    print('http server is running as reverse proxy')\r\n    httpd.serve_forever()\r\n\r\nif __name__ == '__main__':\r\n    main()\r\n```\r\n", "meta": {"posReactions": "0", "negReactions": "0"}}
{"id": "COM23", "speaker": "BrendonW", "conversation_id": "ROOT", "reply_to": "COM22", "timestamp": "2020-06-13T22:59:25Z", "text": "I really wish there was a simple solution to this. It makes developing my Flutter app that interacts with a legacy web-server very difficult. The simplest option would be to give a way of enabling other domains for the debug webserver that AndroidStudio starts, or give me away to enable source-maps in the standalone flutter webserver. \r\n\r\nI can proxy through a server, but then data errors result in incomprehensible errors because source maps never load.\r\nOR\r\nI can run directly out of Android Studio which gives me good errors, but then I can't test any network interactions. \r\n\r\nThe arguments about fooling people into having problems in production is about as valid as saying that debuggers shouldn't be supported because it is not how production works. Making development difficult WILL NOT increase Flutter Web usage.", "meta": {"posReactions": "0", "negReactions": "0"}}
{"id": "COM24", "speaker": "jeansebastienZ", "conversation_id": "ROOT", "reply_to": "COM23", "timestamp": "2020-06-17T14:36:42Z", "text": "So basically no viable solution for this?", "meta": {"posReactions": "0", "negReactions": "0"}}
{"id": "COM25", "speaker": "deakjahn", "conversation_id": "ROOT", "reply_to": "COM24", "timestamp": "2020-06-17T14:56:45Z", "text": "A very simply batch file and it works. https://github.com/flutter/flutter/issues/46904#issuecomment-629363145 I've been using it since my first Flutter Web day and it's still perfect. :-)", "meta": {"posReactions": "0", "negReactions": "0"}}
{"id": "COM26", "speaker": "jeansebastienZ", "conversation_id": "ROOT", "reply_to": "COM25", "timestamp": "2020-06-17T18:55:20Z", "text": "Hello @deakjahn  , This batch will be used on release version ?  If i did understand well no ? Because my problem is calling some webservice  who don't accept CORS. Calling those webservices from my release version.", "meta": {"posReactions": "0", "negReactions": "0"}}
{"id": "COM27", "speaker": "deakjahn", "conversation_id": "ROOT", "reply_to": "COM26", "timestamp": "2020-06-17T19:08:53Z", "text": "No, I thought you meant debugging, this is what the OP talked about. :-)\r\n\r\nIn release mode, you need correct CORS settings. I don't think Flutter can do anything about this, this is a browser security limitation. No webapp can override the security features of the browser; if it could, that would make them completely useless.\r\n\r\nSo there is actually a web service not under your control that doesn't have correct CORS settings? If it is so, how is anybody supposed to use it, quite independent from Flutter?", "meta": {"posReactions": "0", "negReactions": "0"}}
{"id": "COM28", "speaker": "mateusfccp", "conversation_id": "ROOT", "reply_to": "COM27", "timestamp": "2020-06-28T20:30:29Z", "text": "> @deakjahn Thanks! I have adapted your [script solution](https://github.com/flutter/flutter/issues/46904#issuecomment-629363145) in Linux as described below and it works perfectly!\r\n> \r\n> Create a `google-chrome-unsafe.sh` with the following content:\r\n> \r\n> ```\r\n> #!/bin/sh\r\n> /usr/bin/google-chrome-stable --disable-web-security --user-data-dir=\"A-TEMP-LOCATION\" $*\r\n> ```\r\n> \r\n> It's better to create and use a dedicated folder in the home directory instead of `/tmp` for the temporary location, as Chrome will create some folders there to work properly.\r\n> \r\n> Then, make it executable with `chmod a+x google-chrome-unsafe.sh`\r\n> \r\n> The environment variable can be set in `~/.bashrc` or `~/.bash_aliases` (if included from `.bashrc`):\r\n> `export CHROME_EXECUTABLE=/path/to/google-chrome-unsafe.sh`\r\n\r\nThis solution didn't work for me on macOS.\r\n\r\nI made the following script:\r\n```sh\r\n#!/bin/sh\r\n/Applications/Google\\ Chrome.app/Contents/MacOS/Google\\ Chrome --disable-web-security --user-data-dir=\"a-temp-location\" %*\r\n```\r\n\r\nAnd set the `CHROME_EXECUTABLE` variable correctly in my `.profile`.\r\n\r\nWhen I start my Flutter Web app in debug mode it will behave exactly as it was before.", "meta": {"posReactions": "0", "negReactions": "0"}}
{"id": "COM29", "speaker": "deakjahn", "conversation_id": "ROOT", "reply_to": "COM28", "timestamp": "2020-06-28T22:20:13Z", "text": "Did you leave `a-temp-location` verbatim? :-)", "meta": {"posReactions": "0", "negReactions": "0"}}
